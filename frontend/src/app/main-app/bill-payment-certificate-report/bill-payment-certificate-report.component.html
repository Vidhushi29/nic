<div class="row my-4 w-100 mx-0">
    <div class="col-12 d-flex justify-content-center verticle-content-middle">
        <div class="main-content-form-wrapper px-0 py-2">
            <div class="row">
                <form [formGroup]="ngForm">
                    <div class="col-12 px-4 mt-2">
                        <div class="row">
                            <div class="col-md-10 pl-4 pb-2 pb-md-3">
                                <span class="heading_notofied">Bill/Payment/Certificate </span>
                            </div>
                            <div class="col-md-1 pl-4 pb-2"
                                style="font: normal normal 600 20px/30px Poppins; letter-spacing: 0px; color: #1C1C1C;">
                            </div>
                            <div class="col-md-1 pl-4 pb-2"
                                style="font: normal normal 600 20px/30px Poppins; letter-spacing: 0px; color: #1C1C1C;">
                            </div>
                            <div class="col-md-4 pl-2 pt-0 pr-2 py-2 py-md-0 pr-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Year of Indent</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="year_of_indent">
                                        <option value="" selected disabled>Select Year of Indent</option>
                                        <option *ngFor="let data of yearOfIndent" value="{{data.year}}">
                                            {{ data && data.year ? getFinancialYear(data.year) : 'NA'}}</option>
                                    </select>


                                </div>
                            </div>
                            <div class="col-md-4 pl-2 pt-0 pr-2 py-2 py-md-0 pr-md-0 pl-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Season</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="season">
                                        <option value="" selected disabled>Select Season</option>
                                        <option *ngFor="let data of seasonList" value="{{data.season}}">
                                            {{ data && data.season && (data.season=='K')?'Kharif':
                                            (data.season=='R')?'Rabi': (data.season=='O')?'Other':''}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 pl-2 pt-0 pr-2 pr-md-4 py-2 py-md-0 pl-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Crop Type</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="crop_type">
                                        <option value="" selected disabled>Select Crop Type</option>
                                        <option *ngFor="let data of cropTypeList" value="{{data.crop_type}}">
                                            {{ data && data.crop_type ? (data.crop_type |titlecase) :''}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 pl-2 pt-0 pt-md-2 pr-2 py-2 py-md-0 pr-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading">Crop Name</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <ng-multiselect-dropdown [settings]="dropdownSettings" [data]="cropGroupList"
                                        [(ngModel)]="state_cultivation" formControlName="crop_name"
                                        [placeholder]="'Select Crop Name'">
                                    </ng-multiselect-dropdown>
                                </div>
                            </div>
                            <div class="col-md-4 pl-0 pt-0 pt-md-2 pr-4 py-2 py-md-0 pr-md-1 pl-2 pl-md-0">
                                <div class="col-12 pl-3">
                                    <label for="Crop Group" class="left-heading">Variety Name </label>
                                </div>
                                <div class="ccol-12 pr-0 pr-md-0 pl-3">
                                    <ng-multiselect-dropdown [settings]="dropdownSettings1"
                                        [data]="cropVarietListsecond" formControlName="variety_name"
                                        [placeholder]="'Select Variety Name'">
                                    </ng-multiselect-dropdown>
                                </div>
                            </div>

                            <div class="col-12 mt-3 mt-md-4 buttons-phone">
                                <button
                                    class="form-button search ml-2 d-inline-flex justify-content-center verticle-content-middle mb-3 mx-2"
                                    (click)="onSearch()"> Search </button>
                                <button (click)="clear()"
                                    class="clear-form-button ml-2 d-inline-flex justify-content-center verticle-content-middle mb-3">
                                    Clear
                                </button>
                                <div class="dropdown float-right export_dropdown">
                                    <button (click)="myFunction()"
                                        class="form-button  search ml-2 d-inline-flex justify-content-center verticle-content-middle mb-2 mx-2"
                                        style="font-size: 87%;">Export To &nbsp;<i class="fa fa-angle-down"
                                            aria-hidden="true"> </i></button>
                                    <div id="myDropdown" class="dropdown-content">
                                        <a (click)="download()"> <img src="assets\icons\pdf-icon.png" alt=""
                                                width="20px" height="20px"> PDF</a>
                                        <a (click)="exportexcel()"> <img src="assets\icons\excel.jpg" alt=""
                                                width="20px" alt=""> Excel</a>
                                    </div>
                                </div>
                            </div>
                            <div _ngcontent-cvx-c131="" class="col-12 px-4">
                                <hr _ngcontent-cvx-c131="" class="separator m-0">
                            </div>
                        </div>
                    </div>
                </form>
                <div class="col-12 px-4" id="pdf-table">
                    <div class="list-wrapper px-4 py-3">
                        <div class="row d-md-flex data-row-header extra-header">
                            <div class="col-12 col-md-12 py-3 d-flex justify-content-center">Bill/Payment/Certificate
                            </div>
                        </div>
                        <br>
                        <div class="row d-md-flex data-row-header">
                            <div class="col-3 py-3 d-flex verticle-content-middle">
                                Year of Indent :
                                {{enableTable && ngForm.controls['year_of_indent'].value ?
                                getFinancialYear(ngForm.controls['year_of_indent'].value) :''}}
                            </div>
                            <div class="col-sm-2 py-3 d-flex verticle-content-middle">
                                Season :
                                {{ enableTable && ngForm.controls['season'].value &&
                                (ngForm.controls['season'].value=='K')?'Kharif':
                                (ngForm.controls['season'].value=='R')?'Rabi':
                                (ngForm.controls['season'].value=='O')?'Other':''}}
                            </div>
                            <div class="col-sm-3 py-3 d-flex verticle-content-middle">Crop Type :
                                {{enableTable && ngForm.controls['crop_type'].value ?
                                (ngForm.controls['crop_type'].value) :''}}
                            </div>
                            <div class="col-2 py-3 d-flex verticle-content-middle">Unit :
                                {{ngForm.controls['crop_type'].value ?
                                getCropType(ngForm.controls['crop_type'].value) :"" }}
                            </div>

                            <div class="col-2 py-3 d-flex verticle-content-middle float-right">As on Date : {{today
                                |
                                date:"dd-MM-YYYY"}}
                                <!-- {{todayData |
            date:"dd-MM-YYYY"}} -->
                            </div>

                        </div>

                        <!-- Main Table Start -->
                        <div class="row data-row">
                            <table class="table table-bordered table-responsive" *ngIf="enableTable">
                                <thead>
                                    <tr class="data-row-header">
                                        <th scope="col" class="col-md-1 py-2">S/N</th>
                                        <th scope="col" class="col-md-2 py-2">Crop</th>
                                        <th scope="col" class="col-md-2 py-2">Variety</th>
                                        <th scope="col" class="col-md-1 py-2">SPA</th>
                                        <th scope="col" class="col-md-1 py-2">Quantity Allocated</th>
                                        <th scope="col" class="col-md-1 py-2">Amount</th>
                                        <th scope="col" class="col-md-1 py-2">Quantity Lifted</th>
                                        <th scope="col" class="col-md-2 py-2">Bill Number</th>
                                        <th scope="col" class="col-md-3 py-2">Bill Date</th>
                                        <!-- <th scope="col" class="col-md-2 py-2">Label Range</th> -->
                                        <th scope="col" class="col-md-2 py-2">Payment Status</th>
                                        <th scope="col" class="col-md-2 py-2">Status of Certificate</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <ng-container *ngFor="let data of dummyData; let dataIndex = index">
                                        <ng-container
                                            *ngFor="let varietiesData of data.variety; let varityIndex = index">
                                            <ng-container
                                                *ngFor="let SPAsData of varietiesData.spas; let SPAsIndex = index">
                                                <ng-container
                                                    *ngFor="let amountsData of SPAsData.amount; let AmountsIndex = index">
                                                    <tr>
                                                        <td *ngIf="SPAsIndex === 0 && varityIndex === 0 && AmountsIndex===0"
                                                            [attr.rowspan]="data.varietyCount">{{ dataIndex + 1 }}</td>
                                                        <td *ngIf="SPAsIndex === 0 && varityIndex === 0 && AmountsIndex===0"
                                                            [attr.rowspan]="data.varietyCount">{{ data.crop_name ?
                                                            data.crop_name : 'NA' }} </td>
                                                        <td *ngIf="SPAsIndex === 0 && AmountsIndex===0"
                                                            [attr.rowspan]="varietiesData.spa_count">

                                                            {{ varietiesData.variety_name ? varietiesData.variety_name :
                                                            'NA' }} </td>
                                                        <td *ngIf=" AmountsIndex===0"
                                                            [attr.rowspan]="SPAsData.SPAs_count">{{ SPAsData.spa_name ?
                                                            SPAsData.spa_name : 'NA' }} </td>
                                                        <td *ngIf=" AmountsIndex===0"
                                                            [attr.rowspan]="SPAsData.SPAs_count">{{
                                                            SPAsData.allocated_qty ? (SPAsData.allocated_qty.toFixed(2)) : 'NA' }}
                                                        </td>
                                                        <td [attr.rowspan]="amountsData.amount_count">{{
                                                            amountsData.amount ? amountsData.amount : 'NA' }} </td>
                                                        <td [attr.rowspan]="amountsData.amount_count">{{
                                                            amountsData.lifted_qty ? amountsData.lifted_qty : 'NA' }}
                                                        </td>
                                                        <td [attr.rowspan]="amountsData.amount_count">{{
                                                            amountsData.bill_number ? amountsData.bill_number : 'NA' }}
                                                        </td>
                                                        <td [attr.rowspan]="amountsData.amount_count">{{
                                                            amountsData.bill_date ? amountsData.bill_date : 'NA' }}
                                                        </td>
                                                        <td [attr.rowspan]="amountsData.amount_count">{{
                                                            amountsData.is_payment_completed ?
                                                            amountsData.is_payment_completed : 'NA' }} </td>
                                                        <td *ngIf="AmountsIndex===0"
                                                            [attr.rowspan]="SPAsData.SPAs_count">{{
                                                            amountsData.is_certificate_generated ?
                                                            amountsData.is_certificate_generated : 'NA' }} </td>

                                                    </tr>
                                                </ng-container>
                                            </ng-container>
                                        </ng-container>
                                    </ng-container>
                                </tbody>

                            </table>
                            <ng-template #noVarietyData>
                                <div style="text-align: center; width: 100%;">
                                    <p class="my-2 mx-auto">No Data Found</p>
                                </div>
                            </ng-template>
                        </div>
                        <!-- Main Table ends -->

                        <!-- For PDF Table Start -->
                        <div style="display:none" >
                            <div >
                                <span>
                                    <h5>Bill/Payment/Certificate </h5>
                                </span>
                                <div class="row d-md-flex data-row-header" style="zoom: 0.9;">
                                    <div class="col-sm-3 py-3 d-flex verticle-content-middle" style="display:none">
                                        Year of Indent :
                                        {{enableTable && ngForm.controls['year_of_indent'].value ?
                                        getFinancialYear(ngForm.controls['year_of_indent'].value) :''}}

                                    </div>
                                    <div class="col-sm-2 py-3 d-flex verticle-content-middle">
                                        Season :
                                        {{ enableTable && ngForm.controls['season'].value &&
                                        (ngForm.controls['season'].value=='K')?'Kharif':
                                        (ngForm.controls['season'].value=='R')?'Rabi':
                                        (ngForm.controls['season'].value=='O')?'Other':''}}
                                    </div>
                                    <div class="col-sm-2 py-3 d-flex verticle-content-middle">Crop Type :
                                        {{enableTable && ngForm.controls['crop_type'].value ?
                                        (ngForm.controls['crop_type'].value) :''}}
                                    </div>
                                    <div class="col-1 py-3 d-flex verticle-content-middle">Unit :
                                        {{ngForm.controls['crop_type'].value ?
                                        getCropType(ngForm.controls['crop_type'].value) :"" }}
                                    </div>
                                    <div class="col-2 py-3 d-flex verticle-content-middle float-right">As on Date :
                                        {{today
                                        |
                                        date:"dd-MM-YYYY"}}
                                    </div>

                                </div>
                                <div class="row data-row" id="excel-table">
                                    <table class="table table-bordered table-responsive" *ngIf="enableTable">
                                        <thead>
                                            <!-- title -->
                                            <tr>
                                                <th colspan="col-5">Bill/Payment/Certificate </th>
                                            </tr>

                                            <!-- header -->
                                            <tr>
                                                <th>Year of Indent</th>
                                                <th>Season</th>
                                                <th>Crop Type</th>
                                                <th>Unit</th>
                                                <th>As on Date</th>
                                            </tr>

                                            <!-- data /values -->
                                            <tr>
                                                <td>
                                                    {{enableTable && ngForm.controls['year_of_indent'].value ?
                                                    getFinancialYear(ngForm.controls['year_of_indent'].value) :''}}
                                                </td>
                                                <td>
                                                    {{ enableTable && ngForm.controls['season'].value &&
                                                    (ngForm.controls['season'].value=='K')?'Kharif':
                                                    (ngForm.controls['season'].value=='R')?'Rabi':
                                                    (ngForm.controls['season'].value=='O')?'Other':''}}
                                                </td>
                                                <td>

                                                    {{enableTable && ngForm.controls['crop_type'].value ?
                                                    (ngForm.controls['crop_type'].value) :''}}
                                                </td>
                                                <td>
                                                    {{ngForm.controls['crop_type'].value ?
                                                    getCropType(ngForm.controls['crop_type'].value) :"" }}
                                                </td>
                                                <td>
                                                    {{today
                                                    |
                                                    date:"dd-MM-YYYY"}}
                                                </td>
                                            </tr>

                                            <!-- space -->
                                            <tr>
                                                <th></th>
                                            </tr>
                                            <tr class="data-row-header">
                                                <th scope="col" class="col-md-1 py-2">S/N</th>
                                                <th scope="col" class="col-md-2 py-2">Crop</th>
                                                <th scope="col" class="col-md-2 py-2">Variety</th>
                                                <th scope="col" class="col-md-1 py-2">SPA</th>
                                                <th scope="col" class="col-md-1 py-2">Quantity Allocated</th>
                                                <th scope="col" class="col-md-1 py-2">Amount</th>
                                                <th scope="col" class="col-md-1 py-2">Quantity Lifted</th>
                                                <th scope="col" class="col-md-2 py-2">Bill Number</th>
                                                <th scope="col" class="col-md-3 py-2">Bill Date</th>
                                                <!-- <th scope="col" class="col-md-2 py-2">Label Range</th> -->
                                                <th scope="col" class="col-md-2 py-2">Payment Status</th>
                                                <th scope="col" class="col-md-2 py-2">Status of Certificate</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <ng-container *ngFor="let data of dummyData; let dataIndex = index">
                                                <ng-container
                                                    *ngFor="let varietiesData of data.variety; let varityIndex = index">
                                                    <ng-container
                                                        *ngFor="let SPAsData of varietiesData.spas; let SPAsIndex = index">
                                                        <ng-container
                                                            *ngFor="let amountsData of SPAsData.amount; let AmountsIndex = index">
                                                            <tr>
                                                                <td *ngIf="SPAsIndex === 0 && varityIndex === 0 && AmountsIndex===0"
                                                                    [attr.rowspan]="data.variety_count">{{ dataIndex + 1
                                                                    }}</td>
                                                                <td *ngIf="SPAsIndex === 0 && varityIndex === 0 && AmountsIndex===0"
                                                                    [attr.rowspan]="data.variety_count">{{
                                                                    data.crop_name ? data.crop_name : 'NA' }} </td>
                                                                <td *ngIf="SPAsIndex === 0 && AmountsIndex===0"
                                                                    [attr.rowspan]="varietiesData.spa_count">

                                                                    {{ varietiesData.variety_name ?
                                                                    varietiesData.variety_name : 'NA' }} </td>
                                                                <td *ngIf=" AmountsIndex===0"
                                                                    [attr.rowspan]="SPAsData.SPAs_count">{{
                                                                    SPAsData.spa_name ? SPAsData.spa_name : 'NA' }}
                                                                </td>
                                                                <td *ngIf=" AmountsIndex===0"
                                                                    [attr.rowspan]="SPAsData.SPAs_count">{{
                                                                    SPAsData.allocated_qty ? (SPAsData.allocated_qty.toFixed(2)) :
                                                                    'NA' }} </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.amount ? amountsData.amount : 'NA' }}
                                                                </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.lifted_qty ? amountsData.lifted_qty :
                                                                    'NA' }} </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.bill_number ? amountsData.bill_number :
                                                                    'NA' }} </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.bill_date ? amountsData.bill_date : 'NA'
                                                                    }} </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.is_payment_completed ?
                                                                    amountsData.is_payment_completed : 'NA' }} </td>
                                                                <td *ngIf="AmountsIndex===0"
                                                                    [attr.rowspan]="SPAsData.SPAs_count">{{
                                                                    amountsData.is_certificate_generated ?
                                                                    amountsData.is_certificate_generated : 'NA' }} </td>

                                                            </tr>
                                                        </ng-container>
                                                    </ng-container>
                                                </ng-container>
                                            </ng-container>
                                        </tbody>

                                    </table>
                                    <ng-template #noVarietyData>
                                        <div style="text-align: center; width: 100%;">
                                            <p class="my-2 mx-auto">No Data Found</p>
                                        </div>
                                    </ng-template>
                                </div>
                            </div>
                        </div>
                        <!-- For PDF Table Ends -->

                        <!-- For excel Table Start -->
                        <div class="col-12 px-4 data-row" style="display: none;">
                            <div class="list-wrapper px-4 py-3">
                                <br>
                                <div class="row data-row">
                                    <table class="table table-bordered table-responsive" id="excel-tables">
                                        <thead>
                                            <tr class="data-row-header">
                                                <th scope="col" class="col-md-1 py-2">S/N</th>
                                                <th scope="col" class="col-md-2 py-2">Crop</th>
                                                <th scope="col" class="col-md-2 py-2">Variety</th>
                                                <th scope="col" class="col-md-1 py-2">SPA</th>
                                                <th scope="col" class="col-md-1 py-2">Quantity Allocated</th>
                                                <th scope="col" class="col-md-1 py-2">Amount</th>
                                                <th scope="col" class="col-md-1 py-2">Quantity Lifted</th>
                                                <th scope="col" class="col-md-2 py-2">Bill Number</th>
                                                <th scope="col" class="col-md-3 py-2">Bill Date</th>
                                                <th scope="col" class="col-md-2 py-2">Label Range</th>
                                                <th scope="col" class="col-md-2 py-2">Payment Status</th>
                                                <th scope="col" class="col-md-2 py-2">Status of Certificate</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <ng-container *ngFor="let data of dummyData; let dataIndex = index">
                                                <ng-container
                                                    *ngFor="let varietiesData of data.variety; let varityIndex = index">
                                                    <ng-container
                                                        *ngFor="let SPAsData of varietiesData.spas; let SPAsIndex = index">
                                                        <ng-container
                                                            *ngFor="let amountsData of SPAsData.amount; let AmountsIndex = index">
                                                            <tr>
                                                                <td *ngIf="SPAsIndex === 0 && varityIndex === 0 && AmountsIndex===0"
                                                                    [attr.rowspan]="data.variety_count">{{ dataIndex + 1
                                                                    }}</td>
                                                                <td *ngIf="SPAsIndex === 0 && varityIndex === 0 && AmountsIndex===0"
                                                                    [attr.rowspan]="data.variety_count">{{
                                                                    data.crop_name ? data.crop_name : 'NA' }} </td>
                                                                <td *ngIf="SPAsIndex === 0 && AmountsIndex===0"
                                                                    [attr.rowspan]="varietiesData.variety_count">{{
                                                                    varietiesData.variety_name ?
                                                                    varietiesData.variety_name : 'NA' }} </td>
                                                                <td *ngIf=" AmountsIndex===0"
                                                                    [attr.rowspan]="SPAsData.SPAs_count">{{
                                                                    SPAsData.spa_name ? SPAsData.spa_name : 'NA' }}
                                                                </td>
                                                                <td *ngIf=" AmountsIndex===0"
                                                                    [attr.rowspan]="SPAsData.SPAs_count">{{
                                                                    SPAsData.allocated_qty ? (SPAsData.allocated_qty.toFixed(2)) :
                                                                    'NA' }} </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.amount ? amountsData.amount : 'NA' }}
                                                                </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.lifted_qty ? amountsData.lifted_qty :
                                                                    'NA' }} </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.bill_number ? amountsData.bill_number :
                                                                    'NA' }} </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.bill_date ? amountsData.bill_date : 'NA'
                                                                    }} </td>
                                                                <td [attr.rowspan]="amountsData.amount_count">{{
                                                                    amountsData.label_range ? amountsData.label_range :
                                                                    'NA' }} </td>
                                                                <td [attr.rowspan]="1">{{
                                                                    amountsData.is_payment_completed ?
                                                                    amountsData.is_payment_completed : 'NA' }} </td>
                                                                <td *ngIf="AmountsIndex===0"
                                                                    [attr.rowspan]="SPAsData.SPAs_count">{{
                                                                    amountsData.is_certificate_generated ?
                                                                    amountsData.is_certificate_generated : 'NA' }} </td>
                                                            </tr>
                                                        </ng-container>
                                                    </ng-container>
                                                </ng-container>
                                            </ng-container>
                                        </tbody>
                                    </table>
                                    <ng-template #noVarietyData>
                                        <div style="text-align: center; width: 100%;">
                                            <p class="my-2 mx-auto">No Data Found</p>
                                        </div>
                                    </ng-template>
                                </div>
                            </div>
                        </div>
                        <!-- For excel Table ends -->
                        <div class="col-12 px-3   py-3">
                            <!-- <app-pagination-ui></app-pagination-ui> -->
                        </div>

                    </div>
                </div>
            </div>
        </div>