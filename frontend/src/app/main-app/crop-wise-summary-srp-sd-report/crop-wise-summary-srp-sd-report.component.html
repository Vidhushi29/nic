<div class="row my-4 w-100 mx-0">
    <div class="col-12 d-flex justify-content-center verticle-content-middle">
        <div class="main-content-form-wrapper px-0 py-2">
            <div class="row">
                <form [formGroup]="ngForm">
                    <div class="col-12 px-4 mt-2">
                        <div class="row">
                            <div class="col-md-10 pl-4 pb-2 pb-md-3">
                                <span class="heading_notofied">Crop-Wise Summary Seed Rolling Plan</span>
                            </div>
                            <div class="col-md-1 pl-4 pb-2" style="
                  font: normal normal 600 20px/30px Poppins;
                  letter-spacing: 0px;
                  color: #1c1c1c;
                "></div>
                            <div class="col-md-1 pl-4 pb-2" style="
                  font: normal normal 600 20px/30px Poppins;
                  letter-spacing: 0px;
                  color: #1c1c1c;
                "></div>

                            <div class="col-md-4 pl-2 pt-0 pr-2 py-2 py-md-0 pr-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Year</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="year_of_indent">
                                        <option value="" selected disabled>Select Year</option>
                                        <option *ngFor="let data of yearOfIndent" value="{{ data.year }}">
                                            {{ data && data.year ? data.year : "NA" }}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 pl-2 pt-0 pr-2 py-2 py-md-0 pr-md-0 pl-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Season</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="season">
                                        <option value="" selected disabled>Select Season</option>
                                        <option value="all">---All---</option>
                                        <option *ngFor="let data of seasonList" value="{{ data.season }}">
                                            {{ data && data.season ? data.season : "NA" }}
                                        </option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-3 pl-4 pl-md-3 pt-2 pr-4 pr-md-2 py-2 py-md-0">
                                <div class="col-md-12 px-2">
                                    <label for="" class="left-heading">State/UT</label>
                                </div>
                                <div class="col-12 mt-0 px-0 pl-md-0">
                                    <ng-multiselect-dropdown [settings]="dropdownSettings1" [data]="stateIndenterList"
                                        formControlName="state_name" [placeholder]="'Select State Name'">
                                    </ng-multiselect-dropdown>
                                </div>
                            </div>



                            <div class="col-12 mt-3 mt-md-4 buttons-phone">
                                <button
                                    class="form-button search ml-2 d-inline-flex justify-content-center verticle-content-middle mb-3 mx-2"
                                    (click)="onSearch()">
                                    Search
                                </button>
                                <button (click)="clear()"
                                    class="clear-form-button ml-2 d-inline-flex justify-content-center verticle-content-middle mb-3">
                                    Clear
                                </button>

                                <div class="dropdown float-right export_dropdown">
                                    <button (click)="myFunction()"
                                        class="form-button search ml-2 d-inline-flex justify-content-center verticle-content-middle mb-2 mx-2"
                                        style="font-size: 87%">
                                        Export To &nbsp;<i class="fa fa-angle-down" aria-hidden="true">
                                        </i>
                                    </button>
                                    <div id="myDropdown" class="dropdown-content">
                                        <a (click)="download()">
                                            <img src="assets\icons\pdf-icon.png" alt="" width="20px" height="20px" />
                                            PDF</a>
                                        <a (click)="exportexcel()">
                                            <img src="assets\icons\excel.jpg" alt="" width="20px" alt="" />
                                            Excel</a>
                                    </div>
                                </div>
                            </div>

                            <div _ngcontent-cvx-c131="" class="col-12 px-4">
                                <hr _ngcontent-cvx-c131="" class="separator m-0" />
                            </div>
                        </div>
                    </div>
                </form>

                <ng-container>
                    <div class="col-12 px-4 data-row">
                        <div class="list-wrapper px-4 py-3">
                            <div class="row d-md-flex data-row-header extra-header">
                                <div class="col-12 col-md-12 py-3 d-flex justify-content-center">
                                    Crop-Wise Summary Seed Rolling Plan
                                </div>
                            </div>

                            <br />
                            <div>
                                <div class="row d-md-flex data-row-header" style="zoom: 0.9">
                                    <div class="col-3 py-3 d-flex verticle-content-middle">
                                        Year:
                                        {{
                                        enableTable && ngForm.controls["year_of_indent"].value
                                        ? ngForm.controls["year_of_indent"].value
                                        : ""
                                        }}
                                    </div>
                                    <div class="col-3 py-3 d-flex verticle-content-middle">
                                        Season :
                                        {{
                                        enableTable && ngForm.controls["season"].value
                                        ? ngForm.controls["season"].value
                                        : ""
                                        }}
                                    </div>

                                    <div class="col-2 float-right py-3 d-flex float-right">
                                        As on Date : {{ today | date : "dd-MM-YYYY" }}
                                    </div>
                                </div>
                                <div class="row data-row">
                                    <table class="table table-bordered" *ngIf="enableTable">
                                        <thead>
                                            <tr class="data-row-header">
                                                <th scope="col" class="col-md-1 py-2">S/N</th>
                                                <th scope="col" class="col-md-1 py-2">Season</th>
                                                <th scope="col" class="col-md-2 py-2">State/UT</th>
                                                <th scope="col" class="col-md-3 py-2">Crop</th>
                                                <th scope="col" class="col-md-2 py-2">
                                                    Requirement (in Qt)
                                                </th>
                                                <th scope="col" class="col-md-2 py-2">
                                                    Availabilty (in Qt)
                                                </th>
                                                <th scope="col" class="col-md-2 py-2">
                                                    Surplus/Deficit (in Qt)
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                             <ng-container *ngFor="let data of finalData; let seasonIndex = index">
                                                        <ng-container *ngFor="let usersData of data.user; let userIndex = index">
                                                            <ng-container *ngFor="let cropData of usersData.crop; let cropIndex = index">
                                                                <tr>
                                                                    <td style="text-align: center;" *ngIf="userIndex === 0 && cropIndex === 0"
                                                                        [attr.rowspan]="data.user_count + data.crop_count">{{ seasonIndex + 1 }}
                                                                    </td>
                                                                    <td *ngIf="userIndex === 0 && cropIndex === 0 "
                                                                    [attr.rowspan]="data.user_count+ data.crop_count">{{ (data.season |uppercase) }}</td>
                                                            
                                                                    <td *ngIf="cropIndex === 0 "
                                                                    [attr.rowspan]="usersData.user_crop_count">{{ (usersData.user_name |uppercase) }}</td>
                                                            
                                                                    <td  
                                                                    >{{ cropData.crop_name ?
                                                                   cropData.crop_name : 'NA' }}</td>  
                                                               <td style="text-align: center;">{{ cropData.seedRequired ? cropData.seedRequired : 0 }}</td>
                                                                        <td style="text-align: center;">{{ cropData.total ? cropData.total : 0 }}</td>
                                                                     <td style="text-align: center;">{{ cropData.shtorsur ? cropData.shtorsur : 0 }}</td>
                                                                                                                          
                                                                </tr>
                                                    </ng-container>
                                                      
                                                        <tr>
                                                            <td colspan="2"><b>State Wise Total</b></td>
                                                             <td style="text-align: center;"><b>{{usersData.user_seed_req ? usersData.user_seed_req:0  }}</b></td>
                                                               <td style="text-align: center;"><b>{{usersData.user_total ? usersData.user_total:0  }}</b></td>
                                                            <td style="text-align: center;"><b>{{usersData.user_shtorsur ? usersData.user_shtorsur:0  }}</b></td>
                                                                 </tr>
                                                        </ng-container>
                                                        <tr>
                                                            <td colspan="4"><b>Season Wise Total</b></td>
                                                              <td style="text-align: center;"><b>{{data && data.season_req ? data.season_req:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.season_total ? data.season_total:0  }}</b></td>
                                                            <td style="text-align: center;"><b>{{data && data.season_shtorsur ? data.season_shtorsur:0  }}</b></td>
                                                            </tr>
                                                    </ng-container>
                                                        <ng-container>
                                                            <tr>
                                                                <td colspan="4"
                                                                    ><b>TOTAL:</b>
                                                                </td>                                                                                                                                       
                                                                       <td style="text-align: center;"><b>{{ totalData.SeedRequired ? totalData.SeedRequired : 0 }}</b></td>
                                                                  <td style="text-align: center;"><b>{{ totalData.total ? totalData.total : 0 }}</b></td>
                                                                <td style="text-align: center;"><b>{{ totalData.shtorsur ? totalData.shtorsur : 0 }}</b></td>
                                                                    </tr>
                                                   </ng-container>
                                        </tbody>
                                    </table>

                                    <ng-template #noVarietyData>
                                        <div style="text-align: center; width: 100%">
                                            <p class="my-2 mx-auto">No Data Found</p>
                                        </div>
                                    </ng-template>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container>
                    <div class="col-12 px-4 data-row" style="display: none">
                        <div class="list-wrapper px-4 py-3">
                            <br />
                            <div id="excel-table">
                                <div class="row d-md-flex data-row-header extra-header">
                                    <!-- <div class="col-6 col-md-2 py-3 d-flex verticle-content-middle">
                                    </div> -->
                                    <div class="col-12 col-md-12 py-3 d-flex justify-content-center">
                                        Crop-Wise Seed Rolling Plan
                                    </div>
                                    <!-- <div class="col-6 col-md-2 py-3 d-flex verticle-content-middle">
                                    </div> -->
                                </div>

                                <br />
                                <div>
                                    <div class="row d-md-flex data-row-header" style="zoom: 0.9">
                                        <div class="col-3 py-3 d-flex verticle-content-middle">
                                            Year:
                                            {{
                                            enableTable && ngForm.controls["year_of_indent"].value
                                            ? ngForm.controls["year_of_indent"].value
                                            : ""
                                            }}
                                            <!-- {{year}}-{{((year+1)-2000)}} -->
                                        </div>
                                        <div class="col-3 py-3 d-flex verticle-content-middle">
                                            Season :
                                            {{
                                            enableTable && ngForm.controls["season"].value
                                            ? ngForm.controls["season"].value
                                            : ""
                                            }}
                                        </div>

                                        <!-- <div class="col-sm-2 py-3 d-flex verticle-content-middle">Crop:
                                     {{cropNameArr ? (cropNameArr):'' }}
                                    
                                </div>
                               
                                <div class="col-2 py-3 d-flex verticle-content-middle">SPA  : 
                                    {{spa_namesArr  ? getSpafrommlist(spa_namesArr) :''}}
                                </div> -->
                                        <div class="col-2 float-right py-3 d-flex float-right">
                                            As on Date : {{ today | date : "dd-MM-YYYY" }}
                                        </div>
                                    </div>
                                    <div class="row data-row">
                                        <table class="table table-bordered" *ngIf="enableTable">
                                            <thead>
                                                <tr class="data-row-header">
                                                    <th scope="col" class="col-md-1 py-2">S/N</th>
                                                    <th scope="col" class="col-md-1 py-2">Season</th>
                                                    <th scope="col" class="col-md-2 py-2">State/UT</th>
                                                    <th scope="col" class="col-md-3 py-2">Crop</th>
                                                    <th scope="col" class="col-md-2 py-2">
                                                        Requirement (in Qt)
                                                    </th>
                                                    <th scope="col" class="col-md-2 py-2">
                                                        Availabilty (in Qt)
                                                    </th>
                                                    <th scope="col" class="col-md-2 py-2">
                                                        Surplus/Deficit (in Qt)
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <ng-container *ngFor="let data of finalData; let seasonIndex = index">
                                                    <ng-container *ngFor="let usersData of data.user; let userIndex = index">
                                                        <ng-container *ngFor="let cropData of usersData.crop; let cropIndex = index">
                                                            <tr>
                                                                <td style="text-align: center;" *ngIf="userIndex === 0 && cropIndex === 0"
                                                                    [attr.rowspan]="data.user_count + data.crop_count">{{ seasonIndex + 1 }}
                                                                </td>
                                                                <td *ngIf="userIndex === 0 && cropIndex === 0 "
                                                                [attr.rowspan]="data.user_count+ data.crop_count">{{ (data.season |uppercase) }}</td>
                                                        
                                                                <td *ngIf="cropIndex === 0 "
                                                                [attr.rowspan]="usersData.user_crop_count">{{ (usersData.user_name |uppercase) }}</td>
                                                        
                                                                <td  
                                                                >{{ cropData.crop_name ?
                                                               cropData.crop_name : 'NA' }}</td>  
                                                           <td style="text-align: center;">{{ cropData.seedRequired ? cropData.seedRequired : 0 }}</td>
                                                                    <td style="text-align: center;">{{ cropData.total ? cropData.total : 0 }}</td>
                                                                 <td style="text-align: center;">{{ cropData.shtorsur ? cropData.shtorsur : 0 }}</td>
                                                                                                                      
                                                            </tr>
                                                </ng-container>
                                                  
                                                    <tr>
                                                        <td colspan="2"><b>User Wise Total</b></td>
                                                         <td style="text-align: center;"><b>{{usersData.user_seed_req ? usersData.user_seed_req:0  }}</b></td>
                                                           <td style="text-align: center;"><b>{{usersData.user_total ? usersData.user_total:0  }}</b></td>
                                                        <td style="text-align: center;"><b>{{usersData.user_shtorsur ? usersData.user_shtorsur:0  }}</b></td>
                                                             </tr>
                                                    </ng-container>
                                                    <tr>
                                                        <td colspan="4"><b>Season Wise Total</b></td>
                                                          <td style="text-align: center;"><b>{{data && data.season_req ? data.season_req:0  }}</b></td>
                                                         <td style="text-align: center;"><b>{{data && data.season_total ? data.season_total:0  }}</b></td>
                                                        <td style="text-align: center;"><b>{{data && data.season_shtorsur ? data.season_shtorsur:0  }}</b></td>
                                                        </tr>
                                                </ng-container>
                                                    <ng-container>
                                                        <tr>
                                                            <td colspan="4"
                                                                ><b>TOTAL:</b>
                                                            </td>                                                                                                                                       
                                                                   <td style="text-align: center;"><b>{{ totalData.SeedRequired ? totalData.SeedRequired : 0 }}</b></td>
                                                              <td style="text-align: center;"><b>{{ totalData.total ? totalData.total : 0 }}</b></td>
                                                            <td style="text-align: center;"><b>{{ totalData.shtorsur ? totalData.shtorsur : 0 }}</b></td>
                                                                </tr>
                                               </ng-container>
                                            </tbody>
                                        </table>

                                        <ng-template #noVarietyData>
                                            <div style="text-align: center; width: 100%">
                                                <p class="my-2 mx-auto">No Data Found</p>
                                            </div>
                                        </ng-template>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>

                <div class="col-12 px-4 data-row" style="display: none">
                    <div class="list-wrapper px-4 py-3">
                        <br />

                        <div class="row data-row">
                            <table class="table table-bordered table-responsive" id="excel-tables">
                                <thead>
                                    <tr>
                                        <td>Crop-Wise Seed Rolling Plan</td>
                                    </tr>
                                    <tr>
                                        <td>Year</td>
                                        <td>Season</td>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            {{
                                            enableTable && ngForm.controls["year_of_indent"].value
                                            ? ngForm.controls["year_of_indent"].value
                                            : ""
                                            }}
                                        </td>
                                        <td>
                                            {{
                                            enableTable && ngForm.controls["season"].value
                                            ? ngForm.controls["season"].value
                                            : ""
                                            }}
                                        </td>
                                    </tr>
                                </tbody>
                                <thead>
                                    <tr class="data-row-header">
                                        <th scope="col" class="col-md-1 py-2">S/N</th>
                                        <th scope="col" class="col-md-1 py-2">Season</th>
                                        <th scope="col" class="col-md-2 py-2">State/UT</th>
                                        <th scope="col" class="col-md-3 py-2">Crop</th>
                                        <th scope="col" class="col-md-2 py-2">
                                            Requirement (in Qt)
                                        </th>
                                        <th scope="col" class="col-md-2 py-2">
                                            Availabilty (in Qt)
                                        </th>
                                        <th scope="col" class="col-md-2 py-2">
                                            Surplus/Deficit (in Qt)
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <ng-container *ngFor="let data of finalData; let seasonIndex = index">
                                        <ng-container *ngFor="let usersData of data.user; let userIndex = index">
                                            <ng-container *ngFor="let cropData of usersData.crop; let cropIndex = index">
                                                <tr>
                                                    <td style="text-align: center;" *ngIf="userIndex === 0 && cropIndex === 0"
                                                        [attr.rowspan]="data.user_count + data.crop_count">{{ seasonIndex + 1 }}
                                                    </td>
                                                    <td *ngIf="userIndex === 0 && cropIndex === 0 "
                                                    [attr.rowspan]="data.user_count+ data.crop_count">{{ (data.season |uppercase) }}</td>
                                            
                                                    <td *ngIf="cropIndex === 0 "
                                                    [attr.rowspan]="usersData.user_crop_count">{{ (usersData.user_name |uppercase) }}</td>
                                            
                                                    <td  
                                                    >{{ cropData.crop_name ?
                                                   cropData.crop_name : 'NA' }}</td>  
                                               <td style="text-align: center;">{{ cropData.seedRequired ? cropData.seedRequired : 0 }}</td>
                                                        <td style="text-align: center;">{{ cropData.total ? cropData.total : 0 }}</td>
                                                     <td style="text-align: center;">{{ cropData.shtorsur ? cropData.shtorsur : 0 }}</td>
                                                                                                          
                                                </tr>
                                    </ng-container>
                                      
                                        <tr>
                                            <td colspan="2"><b>User Wise Total</b></td>
                                             <td style="text-align: center;"><b>{{usersData.user_seed_req ? usersData.user_seed_req:0  }}</b></td>
                                               <td style="text-align: center;"><b>{{usersData.user_total ? usersData.user_total:0  }}</b></td>
                                            <td style="text-align: center;"><b>{{usersData.user_shtorsur ? usersData.user_shtorsur:0  }}</b></td>
                                                 </tr>
                                        </ng-container>
                                        <tr>
                                            <td colspan="4"><b>Season Wise Total</b></td>
                                              <td style="text-align: center;"><b>{{data && data.season_req ? data.season_req:0  }}</b></td>
                                             <td style="text-align: center;"><b>{{data && data.season_total ? data.season_total:0  }}</b></td>
                                            <td style="text-align: center;"><b>{{data && data.season_shtorsur ? data.season_shtorsur:0  }}</b></td>
                                            </tr>
                                    </ng-container>
                                        <ng-container *ngIf="totalData">
                                            <tr>
                                                <td colspan="4"
                                                    ><b>TOTAL:</b>
                                                </td>                                                                                                                                       
                                                       <td style="text-align: center;"><b>{{ totalData.SeedRequired ? totalData.SeedRequired : 0 }}</b></td>
                                                  <td style="text-align: center;"><b>{{ totalData.total ? totalData.total : 0 }}</b></td>
                                                <td style="text-align: center;"><b>{{ totalData.shtorsur ? totalData.shtorsur : 0 }}</b></td>
                                                    </tr>
                                   </ng-container>
                                </tbody>
                            </table>

                            <ng-template #noVarietyData>
                                <div style="text-align: center; width: 100%">
                                    <p class="my-2 mx-auto">No Data Found</p>
                                </div>
                            </ng-template>
                        </div>
                    </div>
                </div>
                <div class="col-12 px-3 py-3">
                    <app-pagination-ui></app-pagination-ui>
                </div>
                <div *ngIf="
            filterPaginateSearch &&
            filterPaginateSearch.initialized &&
            (!filterPaginateSearch.itemList ||
              filterPaginateSearch.itemList.length < 1)
          " class="px-2 py-3 w-100" style="height: 50px">
                    <div class="d-flex verticle-content-middle justify-content-center w-100">
                        No Data Found.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>