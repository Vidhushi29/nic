<div class="row my-4 w-100 mx-0">
    <div class="col-12 d-flex justify-content-center verticle-content-middle">
        <div class="main-content-form-wrapper px-0 py-2">
            <div class="row">
                <form [formGroup]="ngForm">
                    <div class="col-12 px-4 mt-2">
                        <div class="row">
                            <div class="col-md-10 pl-4 pb-2 pb-md-3">
                                <span class="heading_notofied">Seed Testing Laboratory Results </span>
                            </div>
                            <div class="col-md-1 pl-4 pb-2"
                                style="font: normal normal 600 20px/30px Poppins; letter-spacing: 0px; color: #1C1C1C;">
                            </div>
                            <div class="col-md-1 pl-4 pb-2"
                                style="font: normal normal 600 20px/30px Poppins; letter-spacing: 0px; color: #1C1C1C;">
                            </div>

                            <div class="col-md-4 pl-2 pt-0 pr-2 py-2 py-md-0 pr-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Year of Indent</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="year_of_indent">
                                        <option value="" selected disabled>Select Year of Indent</option>
                                        <option *ngFor="let data of yearOfIndent" value="{{data.year}}">
                                            {{ data && data.year ? getFinancialYear(data.year) : 'NA'}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-4 pl-2 pt-0 pr-2 py-2 py-md-0 pr-md-0 pl-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Season</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="season">
                                        <option value="" selected disabled>Select Season</option>
                                        <option *ngFor="let data of seasonList" value="{{data.season}}">
                                            {{ data && data.season && (data.season=='K')?'Kharif':
                                            (data.season=='R')?'Rabi': (data.season=='O')?'Other':''}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-4 pl-2 pt-0 pr-2 pr-md-4 py-2 py-md-0 pl-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Crop Type</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="crop_type">
                                        <option value="" selected disabled>Select Crop Type</option>
                                        <option *ngFor="let data of cropTypeList" value="{{data.crop_Value}}">
                                            {{ data && data.crop_type ? (data.crop_type |titlecase) :''}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-4 pl-2 pt-0 pt-md-2 pr-2 py-2 py-md-0 pr-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Crop Name</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <!-- <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="crop_name">
                                        <option value="" selected disabled>Select Crop Name</option>
                                        <option *ngFor="let data of cropGroupList" value="{{data.crop_code}}">
                                            {{ data && data['m_crop.crop_name'] ? data['m_crop.crop_name'] :'' }}</option>
                                    </select> -->

                                    <!-- [(ngModel)]="state_cultivation" -->
                                    <ng-multiselect-dropdown [settings]="dropdownSettings" [data]="cropGroupList"
                                        formControlName="crop_name" [placeholder]="'Select Crop Name'">
                                    </ng-multiselect-dropdown>
                                </div>
                            </div>

                            <div class="col-md-4 pl-0 pt-0 pt-md-2 pr-4 py-2 py-md-0 pr-md-1 pl-2 pl-md-0">
                                <div class="col-12 pl-3">
                                    <label for="Crop Group" class="left-heading required">Variety Name </label>
                                </div>
                                <div class="ccol-12 pr-0 pr-md-0 pl-3">
                                    <!-- <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="variety_name">
                                        <option value="" selected disabled>Select Variety Name</option>
                                        <option *ngFor="let data of cropVarietListsecond" value="{{data && data.variety_id ? data.variety_id :''}}">
                                            {{ data && data['m_crop_variety.variety_name'] ? data['m_crop_variety.variety_name'] :'' }}</option>
                                    </select> -->

                                    <ng-multiselect-dropdown [settings]="dropdownSettings1"
                                        [data]="cropVarietListsecond" formControlName="variety_name"
                                        [placeholder]="'Select Variety Name'">
                                    </ng-multiselect-dropdown>
                                </div>
                            </div>

                            <div class="col-md-4 pl-2  pt-0 pt-md-2 pr-2 pr-md-4 py-2 py-md-0 pl-md-0">
                                <div class="col-12">
                                    <label for="Lot Numbers" class="left-heading">Lot Number</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="lot_numbers">
                                        <option value="" selected disabled>Select Lot Number</option>
                                        <option *ngFor="let data of lotNumberList"
                                            value="{{data && data.lot_id ? data.lot_id :''}}">{{data && data.lot_number
                                            ? data.lot_number :''}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-4 pl-2 pt-0 pt-md-2 pr-2 py-2 py-md-0 pr-md-0">
                                <div class="col-12">
                                    <label for="Report Status" class="left-heading">Report Status</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="report_status">
                                        <option value="" selected disabled>Select Report Status</option>
                                        <option *ngFor="let data of reportStatuslift"
                                            value="{{ data && data.is_report_pass  ?   data.is_report_pass  :''}}">{{
                                            data && data.is_report_pass && (data.is_report_pass=='false')? 'Fail' :
                                            "Pass" }}</option>
                                        <!-- <option value="false">Fail</option> -->
                                    </select>
                                </div>
                            </div>

                            <div class="col-12 mt-3 mt-md-4 buttons-phone">
                                <button
                                    class="form-button search ml-2 d-inline-flex justify-content-center verticle-content-middle mb-3 mx-2"
                                    (click)="onSearch()"> Search </button>
                                <button (click)="clear()"
                                    class="clear-form-button ml-2 d-inline-flex justify-content-center verticle-content-middle mb-3">
                                    Clear
                                </button>
                                <div class="dropdown float-right export_dropdown">
                                    <button (click)="myFunction()"
                                        class="form-button  search ml-2 d-inline-flex justify-content-center verticle-content-middle mb-2 mx-2"
                                        style="font-size: 87%;">Export To &nbsp;<i class="fa fa-angle-down"
                                            aria-hidden="true"> </i></button>
                                    <div id="myDropdown" class="dropdown-content">
                                        <a (click)="download()"> <img src="assets\icons\pdf-icon.png" alt=""
                                                width="20px" height="20px"> PDF</a>
                                        <a (click)="exportexcel()"> <img src="assets\icons\excel.jpg" alt=""
                                                width="20px" alt=""> Excel</a>
                                    </div>
                                </div>
                            </div>

                            <div _ngcontent-cvx-c131="" class="col-12 px-4">
                                <hr _ngcontent-cvx-c131="" class="separator m-0">
                            </div>

                        </div>
                    </div>
                </form>

                <div class="col-12 px-4" id="excel-table">

                    <div class="list-wrapper px-4 py-3">
                        <div class="row d-md-flex data-row-header extra-header">
                            <div class="col-12 col-md-12 py-3 d-flex justify-content-center">Seed Testing Laboratory
                                Results </div>
                        </div>
                        <br>
                        <div class="row d-md-flex data-row-header">
                            <div class="col-2 col-sm-2py-3 d-flex verticle-content-middle">
                                Year of Indent :
                                {{enableTable && ngForm.controls['year_of_indent'].value ?
                                getFinancialYear(ngForm.controls['year_of_indent'].value) :''}}
                            </div>
                            <div class="col-2 col-sm-2 py-3 d-flex verticle-content-middle">
                                Season :
                                {{ enableTable && ngForm.controls['season'].value &&
                                (ngForm.controls['season'].value=='K')?'Kharif':
                                (ngForm.controls['season'].value=='R')?'Rabi':
                                (ngForm.controls['season'].value=='O')?'Other':''}}
                            </div>
                            <div class="col-2 col-sm-2 py-3 d-flex verticle-content-middle">Crop Type :
                                {{enableTable && ngForm.controls['crop_type'].value &&
                                (ngForm.controls['crop_type'].value) &&
                                (ngForm.controls['crop_type'].value=='A')?'Agriculture'
                                :(ngForm.controls['crop_type'].value=='H')? 'Horiticultue':''}}
                            </div>
                            <div class="col-2 col-sm-2 py-3 d-flex verticle-content-middle">Unit :
                                {{ngForm.controls['crop_type'].value ?
                                getCropType(ngForm.controls['crop_type'].value) :"" }}
                            </div>
                            <div class="col-2 col-sm-2 py-3 d-flex verticle-content-middle">Crop :
                                {{enableTable && ngForm.controls['crop_name'].value ?
                                getCropNamefrommlist(ngForm.controls['crop_name'].value) :''}}
                            </div>
                            <div class="col-2 col-sm-2 py-3 d-flex verticle-content-middle">Variety :
                                {{enableTable && ngForm.controls['variety_name'].value ?
                                getVarietyfrommlist(ngForm.controls['variety_name'].value) :''}}
                            </div>

                            <div class="col-2 col-sm-2 py-3 d-flex verticle-content-middle float-right">As on Date : {{today
                                |
                                date:"dd-MM-YYYY"}}
                            </div>

                        </div>

                        <!-- main Table Starts -->
                        <div class="row data-row">

                            <table class="table table-bordered table-responsive" *ngIf="enableTable">
                                <thead>
                                    <tr class="data-row-header">
                                        <th scope="col" class="col-md-1 py-2" rowspan="2">S/N</th>
                                        <th scope="col" class="col-md-2 py-2" rowspan="2">Variety</th>
                                        <th scope="col" class="col-md-1 py-2" rowspan="2">LOT Numbers</th>
                                        <th scope="col" class="col-md-1 py-2" rowspan="2">LOT Size</th>
                                        <th scope="col" class="col-md-1 py-2" rowspan="2">Reference Number</th>
                                        <th scope="col" class="col-md-1 py-2" rowspan="2">Sample Number</th>
                                        <th scope="col" class="col-md-2 py-2" rowspan="2">Date of Test</th>
                                        <th scope="col" class="col-md-3 py-2" rowspan="2">Report receiving Date</th>
                                        <th scope="col" class="col-md-2 py-2" rowspan="2">% of Different seeding Classes
                                    <tr>
                                        <th scope="col" class="col-md-2 py-2">Normal</th>
                                        <th scope="col" class="col-md-2 py-2">Abnormal</th>
                                        <th scope="col" class="col-md-2 py-2">Hard</th>
                                        <th scope="col" class="col-md-2 py-2">Fresh Ungerminated</th>
                                        <th scope="col" class="col-md-2 py-2">Dead</th>
                                    </tr>
                                    </th>
                                    <th scope="col" class="col-md-2 py-2">% of Physical Purity
                                        <tr>
                                            <th scope="col" class="col-md-2 py-2">Pure Seed</th>
                                            <th scope="col" class="col-md-2 py-2">Other Crop Seed</th>
                                            <th scope="col" class="col-md-2 py-2">Weed Seed</th>
                                            <th scope="col" class="col-md-2 py-2">Inert Matter</th>
                                        </tr>
                                    </th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">Moisture</th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">Report Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <ng-container *ngFor="let data of dummyData; let dataIndex = index">
                                        <ng-container
                                            *ngFor="let varietiesDetails of data.variety; let varityDetails = index">
                                            <tr>
                                                <td *ngIf="varityDetails === 0" [attr.rowspan]="data.variety_count">{{
                                                    dataIndex + 1 }}</td>
                                                <td *ngIf=" varityDetails === 0" [attr.rowspan]="data.variety_count">{{
                                                    data.variety_name ? data.variety_name : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                    varietiesDetails.lot_number ? varietiesDetails.lot_number : 'NA' }}
                                                </td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                    varietiesDetails.lot_size ? varietiesDetails.lot_size : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                    varietiesDetails.reference_number ?
                                                    varietiesDetails.reference_number : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                    varietiesDetails.sample_number ? varietiesDetails.sample_number :
                                                    'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                    varietiesDetails.date_of_test ? varietiesDetails.date_of_test : 'NA'
                                                    }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                    varietiesDetails.report_recieving_date ?
                                                    varietiesDetails.report_recieving_date : 'NA' }}</td>
                                                <span>
                                            <tr>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                    varietiesDetails.normal ? varietiesDetails.normal : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                    varietiesDetails.abnormal ? varietiesDetails.abnormal : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.hard
                                                    ? varietiesDetails.hard : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                    varietiesDetails.fresh_ungerminated ?
                                                    varietiesDetails.fresh_ungerminated : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.dead
                                                    ? varietiesDetails.dead : 'NA' }} </td>
                                            </tr>
                                            </span>
                                            <td>
                                                <tr>
                                                    <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                        varietiesDetails.pure_seed ? varietiesDetails.pure_seed : 'NA'
                                                        }}</td>
                                                    <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                        varietiesDetails.other_crop_seed ?
                                                        varietiesDetails.other_crop_seed : 'NA' }} </td>
                                                    <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                        varietiesDetails.weed_seed ? varietiesDetails.weed_seed : 'NA'
                                                        }}</td>
                                                    <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                        varietiesDetails.inert_matter ? varietiesDetails.inert_matter :
                                                        'NA' }}</td>
                                                </tr>
                                            </td>

                                            <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.moisture
                                                ? varietiesDetails.moisture : 'NA' }}</td>
                                            <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                varietiesDetails.is_report_pass ? varietiesDetails.is_report_pass : 'NA'
                                                }}</td>
                                            </tr>
                                        </ng-container>
                                    </ng-container>
                                </tbody>

                            </table>

                            <ng-template #noVarietyData>
                                <div style="text-align: center; width: 100%;">
                                    <p class="my-2 mx-auto">No Data Found</p>
                                </div>
                            </ng-template>
                        </div>
                        <!-- main Table Ends -->

                        <!-- For PDF Start -->

                        <div style="display:none">
                            <div>
                                <span>
                                    <h5>Seed Testing Laboratory Results </h5>
                                </span>

                                <div class="row d-md-flex data-row-header" style="zoom: 0.9;">
                                    <div class="col-sm-2 py-3 d-flex verticle-content-middle" style="display:none">
                                        Year of Indent :
                                        {{enableTable && ngForm.controls['year_of_indent'].value ?
                                        getFinancialYear(ngForm.controls['year_of_indent'].value) :''}}

                                    </div>
                                    <div class="col-sm-1 py-3 d-flex verticle-content-middle">
                                        Season :
                                        {{ enableTable && ngForm.controls['season'].value &&
                                        (ngForm.controls['season'].value=='K')?'Kharif':
                                        (ngForm.controls['season'].value=='R')?'Rabi':
                                        (ngForm.controls['season'].value=='O')?'Other':''}}
                                    </div>
                                    <div class="col-sm-2 py-3 d-flex verticle-content-middle">Crop Type :
                                        {{enableTable && ngForm.controls['crop_type'].value &&
                                        (ngForm.controls['crop_type'].value) &&
                                        (ngForm.controls['crop_type'].value=='A')?'Agriculture'
                                        :(ngForm.controls['crop_type'].value=='H')? 'Horiticultue':''}}
                                    </div>
                                    <div class="col-1 py-3 d-flex verticle-content-middle">Unit :
                                        {{ngForm.controls['crop_type'].value ?
                                        getCropType(ngForm.controls['crop_type'].value) :"" }}
                                    </div>
                                    <div class="col-sm-1 py-3 d-flex verticle-content-middle">Crop :
                                        {{enableTable && ngForm.controls['crop_name'].value ?
                                        getCropNamefrommlist(ngForm.controls['crop_name'].value) :''}}
                                    </div>
                                    <div class="col-sm-2 py-3 d-flex verticle-content-middle">Variety :
                                        {{enableTable && ngForm.controls['variety_name'].value ?
                                        getVarietyfrommlist(ngForm.controls['variety_name'].value) :''}}
                                    </div>

                                    <div class="col-3 py-3 d-flex verticle-content-middle float-right">As on Date :
                                        {{today
                                        |
                                        date:"dd-MM-YYYY"}}
                                    </div>

                                </div>
                                <div class="row data-row">

                                    <table class="table table-bordered table-responsive" *ngIf="enableTable">
                                        <thead>
                                            <tr class="data-row-header">
                                                <th scope="col" class="col-md-1 py-2" rowspan="2">S/N</th>
                                                <th scope="col" class="col-md-2 py-2" rowspan="2">Variety</th>
                                                <th scope="col" class="col-md-1 py-2" rowspan="2">LOT Numbers</th>
                                                <th scope="col" class="col-md-1 py-2" rowspan="2">LOT Size</th>
                                                <th scope="col" class="col-md-1 py-2" rowspan="2">Reference Number</th>
                                                <th scope="col" class="col-md-1 py-2" rowspan="2">Sample Number</th>
                                                <th scope="col" class="col-md-2 py-2" rowspan="2">Date of Test</th>
                                                <th scope="col" class="col-md-3 py-2" rowspan="2">Report receiving Date
                                                </th>
                                                <th scope="col" class="col-md-2 py-2" rowspan="2">% of Different seeding
                                                    Classes
                                            <tr>
                                                <th scope="col" class="col-md-2 py-2">Normal</th>
                                                <th scope="col" class="col-md-2 py-2">Abnormal</th>
                                                <th scope="col" class="col-md-2 py-2">Hard</th>
                                                <th scope="col" class="col-md-2 py-2">Fresh Ungerminated</th>
                                                <th scope="col" class="col-md-2 py-2">Dead</th>
                                            </tr>
                                            </th>
                                            <th scope="col" class="col-md-2 py-2">% of Physical Purity
                                                <tr>
                                                    <th scope="col" class="col-md-2 py-2">Pure Seed</th>
                                                    <th scope="col" class="col-md-2 py-2">Other Crop Seed</th>
                                                    <th scope="col" class="col-md-2 py-2">Weed Seed</th>
                                                    <th scope="col" class="col-md-2 py-2">Inert Matter</th>
                                                </tr>
                                            </th>
                                            <th scope="col" class="col-md-2 py-2" rowspan="2">Moisture</th>
                                            <th scope="col" class="col-md-2 py-2" rowspan="2">Report Status</th>
                                            </tr>

                                        </thead>
                                        <tbody>
                                            <ng-container *ngFor="let data of dummyData; let dataIndex = index">
                                                <ng-container
                                                    *ngFor="let varietiesDetails of data.variety; let varityDetails = index">
                                                    <tr>
                                                        <td *ngIf="varityDetails === 0"
                                                            [attr.rowspan]="data.variety_count">{{ dataIndex + 1 }}</td>
                                                        <td *ngIf=" varityDetails === 0"
                                                            [attr.rowspan]="data.variety_count">{{ data.variety_name ?
                                                            data.variety_name : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.lot_number ? varietiesDetails.lot_number :
                                                            'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.lot_size ? varietiesDetails.lot_size : 'NA'
                                                            }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.reference_number ?
                                                            varietiesDetails.reference_number : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.sample_number ?
                                                            varietiesDetails.sample_number : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.date_of_test ?
                                                            varietiesDetails.date_of_test : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.report_recieving_date ?
                                                            varietiesDetails.report_recieving_date : 'NA' }}</td>
                                                        <span>
                                                    <tr>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.normal ? varietiesDetails.normal : 'NA' }}
                                                        </td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.abnormal ? varietiesDetails.abnormal : 'NA'
                                                            }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.hard ? varietiesDetails.hard : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.fresh_ungerminated ?
                                                            varietiesDetails.fresh_ungerminated : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.dead ? varietiesDetails.dead : 'NA' }}
                                                        </td>
                                                    </tr>
                                                    </span>
                                                    <td>
                                                        <tr>
                                                            <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                                varietiesDetails.pure_seed ? varietiesDetails.pure_seed
                                                                : 'NA' }}</td>
                                                            <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                                varietiesDetails.other_crop_seed ?
                                                                varietiesDetails.other_crop_seed : 'NA' }} </td>
                                                            <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                                varietiesDetails.weed_seed ? varietiesDetails.weed_seed
                                                                : 'NA' }}</td>
                                                            <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                                varietiesDetails.inert_matter ?
                                                                varietiesDetails.inert_matter : 'NA' }}</td>
                                                        </tr>
                                                    </td>

                                                    <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                        varietiesDetails.moisture ? varietiesDetails.moisture : 'NA' }}
                                                    </td>
                                                    <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                        varietiesDetails.is_report_pass ?
                                                        varietiesDetails.is_report_pass : 'NA' }}</td>
                                                    </tr>
                                                </ng-container>
                                            </ng-container>
                                        </tbody>

                                    </table>
                                    <ng-template #noVarietyData>
                                        <div style="text-align: center; width: 100%;">
                                            <p class="my-2 mx-auto">No Data Found</p>
                                        </div>
                                    </ng-template>
                                </div>
                            </div>
                        </div>
                        <!-- For PDF Ends -->


                        <!-- for Excel Start -->

                        <div class="col-12 px-4 data-row" style="display: none;">
                            <div class="list-wrapper px-4 py-3">

                                <br>

                                <div class="row data-row">
                                    <table class="table table-bordered table-responsive" id="excel-tables">
                                        <thead>
                                            <!-- title -->
                                            <tr>
                                                <th>Seed Testing Laboratory Results</th>
                                            </tr>

                                            <!-- heading -->
                                            <tr>
                                                <th>Year of Indent</th>
                                                <th>Season</th>
                                                <th>Crop Type</th>
                                                <th>Unit</th>
                                                <th>Crop Name</th>
                                                <th>Variety Name</th>
                                                <th>As on Date</th>
                                            </tr>

                                            <!-- values -->
                                            <tr>
                                                <td>

                                                    {{enableTable && ngForm.controls['year_of_indent'].value ?
                                                    getFinancialYear(ngForm.controls['year_of_indent'].value) :''}}
                                                </td>
                                                <td>
                                                    {{ enableTable && ngForm.controls['season'].value &&
                                                    (ngForm.controls['season'].value=='K')?'Kharif':
                                                    (ngForm.controls['season'].value=='R')?'Rabi':
                                                    (ngForm.controls['season'].value=='O')?'Other':''}}
                                                </td>
                                                <td>
                                                    {{enableTable && ngForm.controls['crop_type'].value &&
                                                    (ngForm.controls['crop_type'].value) &&
                                                    (ngForm.controls['crop_type'].value=='A')?'Agriculture'
                                                    :(ngForm.controls['crop_type'].value=='H')? 'Horiticultue':''}}
                                                </td>
                                                <td>
                                                    {{ngForm.controls['crop_type'].value ?
                                                    getCropType(ngForm.controls['crop_type'].value) :"" }}
                                                </td>
                                                <td>
                                                    {{enableTable && ngForm.controls['crop_name'].value ?
                                                    getCropNamefrommlist(ngForm.controls['crop_name'].value) :''}}
                                                </td>
                                                <td>
                                                    {{enableTable && ngForm.controls['variety_name'].value ?
                                                    getVarietyfrommlist(ngForm.controls['variety_name'].value) :''}}
                                                </td>
                                                <td>
                                                    {{today
                                                    |
                                                    date:"dd-MM-YYYY"}}
                                                </td>
                                            </tr>

                                            <!-- spaces -->
                                            <tr>
                                                <th></th>
                                            </tr>

                                            <tr class="data-row-header">
                                                <th scope="col" class="col-md-1 py-2">S/N</th>
                                                <th scope="col" class="col-md-2 py-2">Variety</th>
                                                <th scope="col" class="col-md-1 py-2">LOT Numbers</th>
                                                <th scope="col" class="col-md-1 py-2">LOT Size</th>
                                                <th scope="col" class="col-md-1 py-2">Reference Number</th>
                                                <th scope="col" class="col-md-1 py-2">Sample Number</th>
                                                <th scope="col" class="col-md-2 py-2">Date of Test</th>
                                                <th scope="col" class="col-md-3 py-2">Report receiving Date</th>


                                                <th scope="col" class="col-md-2 py-2">Normal</th>
                                                <th scope="col" class="col-md-2 py-2">Abnormal</th>
                                                <th scope="col" class="col-md-2 py-2">Hard</th>
                                                <th scope="col" class="col-md-2 py-2">Fresh Ungerminated</th>
                                                <th scope="col" class="col-md-2 py-2">Dead</th>




                                                <th scope="col" class="col-md-2 py-2">Pure Seed</th>
                                                <th scope="col" class="col-md-2 py-2">Other Crop Seed</th>
                                                <th scope="col" class="col-md-2 py-2">Weed Seed</th>
                                                <th scope="col" class="col-md-2 py-2">Inert Matter</th>

                                                <th scope="col" class="col-md-2 py-2">Moisture</th>
                                                <th scope="col" class="col-md-2 py-2">Report Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- <ng-container *ngFor="let data of dummyData; let dataIndex = index">
                                        <ng-container *ngFor="let varietiesDetails of data.variety; let varityDetails = index">   
                                            <tr>
                                                <td *ngIf="varityDetails === 0" [attr.rowspan]="data.variety_count">{{ dataIndex + 1 }}</td>          
                                                <td *ngIf=" varityDetails === 0" [attr.rowspan]="data.variety_count">{{ data.variety_name ? data.variety_name : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.lot_number ? varietiesDetails.lot_number : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.lot_size ? varietiesDetails.lot_size : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.reference_number ? varietiesDetails.reference_number : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.sample_number ? varietiesDetails.sample_number : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.date_of_test ? varietiesDetails.date_of_test : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.report_recieving_date ? varietiesDetails.report_recieving_date : 'NA' }}</td>
                                                <span>
                                                    <tr>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.normal ? varietiesDetails.normal : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.abnormal ? varietiesDetails.abnormal : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.hard ? varietiesDetails.hard : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.fresh_ungerminated ? varietiesDetails.fresh_ungerminated : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.dead ? varietiesDetails.dead : 'NA' }} </td>
                                                    </tr>
                                                </span>
                                                <td>
                                                    <tr>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.pure_seed ? varietiesDetails.pure_seed : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.other_crop_seed ? varietiesDetails.other_crop_seed : 'NA' }} </td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.weed_seed ? varietiesDetails.weed_seed : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.inert_matter ? varietiesDetails.inert_matter : 'NA' }}</td>
                                                    </tr>
                                                </td>
                            
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.moisture ? varietiesDetails.moisture : 'NA' }}</td>
                                                <td [attr.rowspan]="varietiesDetails.spa_count">{{ varietiesDetails.is_report_pass ?  varietiesDetails.is_report_pass : 'NA' }}</td>   
                                            </tr>
                                        </ng-container>
                                     </ng-container>  -->
                                            <ng-container *ngFor="let data of dummyData; let dataIndex = index">
                                                <ng-container
                                                    *ngFor="let varietiesDetails of data.variety; let varityDetails = index">

                                                    <tr>
                                                        <td *ngIf="varityDetails === 0"
                                                            [attr.rowspan]="data.variety_count">{{ dataIndex + 1 }}</td>
                                                        <td *ngIf=" varityDetails === 0"
                                                            [attr.rowspan]="data.variety_count">{{ data.variety_name ?
                                                            data.variety_name : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.lot_number ? varietiesDetails.lot_number :
                                                            'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.lot_size ? varietiesDetails.lot_size : 'NA'
                                                            }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.reference_number ?
                                                            varietiesDetails.reference_number : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.sample_number ?
                                                            varietiesDetails.sample_number : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.date_of_test ?
                                                            varietiesDetails.date_of_test : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.report_recieving_date ?
                                                            varietiesDetails.report_recieving_date : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.normal ? varietiesDetails.normal : 'NA' }}
                                                        </td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.abnormal ? varietiesDetails.abnormal : 'NA'
                                                            }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.hard ? varietiesDetails.hard : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.fresh_ungerminated ?
                                                            varietiesDetails.fresh_ungerminated : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.dead ? varietiesDetails.dead : 'NA' }}
                                                        </td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.pure_seed ? varietiesDetails.pure_seed :
                                                            'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.other_crop_seed ?
                                                            varietiesDetails.other_crop_seed : 'NA' }} </td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.weed_seed ? varietiesDetails.weed_seed :
                                                            'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.inert_matter ?
                                                            varietiesDetails.inert_matter : 'NA' }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.moisture ? varietiesDetails.moisture : 'NA'
                                                            }}</td>
                                                        <td [attr.rowspan]="varietiesDetails.spa_count">{{
                                                            varietiesDetails.is_report_pass ?
                                                            varietiesDetails.is_report_pass : 'NA' }}</td>
                                                    </tr>

                                                </ng-container>
                                            </ng-container>
                                        </tbody>

                                    </table>
                                    <ng-template #noVarietyData>
                                        <div style="text-align: center; width: 100%;">
                                            <p class="my-2 mx-auto">No Data Found</p>
                                        </div>
                                    </ng-template>
                                </div>


                            </div>
                        </div>

                        <!-- for Excel Ends -->
                        <div class="col-12 px-3   py-3">
                            <!-- <app-pagination-ui></app-pagination-ui> -->
                        </div>

                    </div>
                </div>
            </div>
        </div>