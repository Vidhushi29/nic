<div class="row my-4 w-100 mx-0">
    <div class="col-12 d-flex justify-content-center verticle-content-middle">
        <div class="main-content-form-wrapper px-0 py-2">
            <div class="row">
                <form [formGroup]="ngForm">
                    <div class="col-12 px-4 mt-2">
                        <div class="row">
                            <div class="col-md-10 pl-4 pb-2 pb-md-3">
                                <span class="heading_notofied">Crop Variety-Wise Seed Rolling Plan</span>
                            </div>
                            <div class="col-md-1 pl-4 pb-2"
                                style="font: normal normal 600 20px/30px Poppins; letter-spacing: 0px; color: #1C1C1C;">
                            </div>
                            <div class="col-md-1 pl-4 pb-2"
                                style="font: normal normal 600 20px/30px Poppins; letter-spacing: 0px; color: #1C1C1C;">
                            </div>


                            <div class="col-md-4 pl-2 pt-0 pr-2 py-2 py-md-0 pr-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Year</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="year_of_indent">
                                        <option value="" selected disabled>Select Year</option>
                                        <option *ngFor="let data of yearOfIndent" value="{{data.year}}">
                                            {{ data && data.year ? data.year : 'NA'}}</option>
                                    </select>


                                </div>
                            </div>
                            <div class="col-md-4 pl-2 pt-0 pr-2 py-2 py-md-0 pr-md-0 pl-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading required">Season</label>
                                </div>
                                <div class="col-12 pr-md-0">
                                    <select class="form-select form-control" aria-label="Default select example"
                                        formControlName="season">
                                        <option value="" selected disabled>Select Season</option>
                                        <option *ngFor="let data of seasonList" value="{{data.season}}">
                                            {{ data && data.season ? data.season : 'NA'}}</option>
                                    </select>


                                </div>
                            </div>
                            <div class="col-md-4 pl-2 pt-0 pr-2 py-2 py-md-0 pl-md-0">
                                <div class="col-12">
                                    <label for="Crop Group" class="left-heading">Crop Name</label>
                                </div>
                                <div class="col-12 pr-md-3 mb-2">
                                    <ng-multiselect-dropdown [settings]="dropdownSettings1" [data]="cropVarietList"
                                   
                                   formControlName="crop_name"                                  
                                   [placeholder]="'Select Crop Name'">
                               </ng-multiselect-dropdown>

                                </div>
                            </div>

                          
                        
                            <div class="col-12 mt-3 mt-md-4 buttons-phone">
                                <button
                                    class="form-button search ml-2 d-inline-flex justify-content-center verticle-content-middle mb-3 mx-2"
                                    (click)="onSearch()"> Search </button>
                                <button (click)="clear()"
                                    class="clear-form-button ml-2 d-inline-flex justify-content-center verticle-content-middle mb-3">
                                    Clear
                                </button>


                                <div class="dropdown float-right export_dropdown">
                                    <button (click)="myFunction()"
                                        class="form-button  search ml-2 d-inline-flex justify-content-center verticle-content-middle mb-2 mx-2"
                                        style="font-size: 87%;">Export To &nbsp;<i class="fa fa-angle-down"
                                            aria-hidden="true"> </i></button>
                                    <div id="myDropdown" class="dropdown-content">
                                        <a (click)="download()"> <img src="assets\icons\pdf-icon.png" alt=""
                                                width="20px" height="20px"> PDF</a>
                                        <a (click)="exportexcel()"> <img src="assets\icons\excel.jpg" alt=""
                                                width="20px" alt=""> Excel</a>
                                    </div>
                                </div>

                            </div>





                            <div _ngcontent-cvx-c131="" class="col-12 px-4">
                                <hr _ngcontent-cvx-c131="" class="separator m-0">
                            </div>
                        </div>
                    </div>
                </form>
               
                <ng-container >

                    <div class="col-12 px-4 data-row"  >
                        <div class="list-wrapper px-4 py-3">
                            <div class="row d-md-flex data-row-header extra-header ">
                                        <!-- <div class="col-6 col-md-2 py-3 d-flex verticle-content-middle">
                                        </div> -->
                                        <div class="col-12 col-md-12 py-3 d-flex justify-content-center">Crop Variety-Wise Seed Rolling Plan
                                        </div>
                                        <!-- <div class="col-6 col-md-2 py-3 d-flex verticle-content-middle">
                                        </div> -->
                                    </div>
                           
                            <br>
                            <div >

                                <div class="row d-md-flex data-row-header" style="zoom: 0.9;"  *ngIf="enableTable">
                                    <div class="col-4 py-3 d-flex verticle-content-middle" >
                                        Year:
                                        {{enableTable && ngForm.controls['year_of_indent'].value ? ngForm.controls['year_of_indent'].value :''}}
                                        <!-- {{year}}-{{((year+1)-2000)}} -->
                                    </div>
                                    <div class="col-4 py-3 d-flex verticle-content-middle">
                                        Season :
                                        {{ enableTable && ngForm.controls['season'].value? ngForm.controls['season'].value :''}}
                                     
                                    </div>
                                  
                                  
                                    <div class="col-4 py-3 d-flex verticle-content-middle  float-right " >As on Date : {{today |
                                        date:"dd-MM-YYYY"}}
                                     
                                    </div>
        
                                </div>
                                <div class="row data-row" >
        
                                    <table class="table table-bordered table-responsive"  *ngIf="enableTable">
                                     
                                        <thead>                                        
                                   <tr class="data-row-header">
                                    <th scope="col" class="col-md-1 py-2" rowspan="2">S/N</th>
                                    <th scope="col" class="col-md-3 py-2" rowspan="2">Crop</th>
                                    <th scope="col" class="col-md-3 py-2" rowspan="2">Variety</th>
                                    <th scope="col" class="col-md-3 py-2" rowspan="2">Year of Notification</th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">Area (in Ha)</th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">Seed Rate (In Qt/Ha)</th>
                                    <th scope="col" class="col-md-3 py-2" rowspan="2">SRR Proposed (by State) % </th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">Seed Required (in Qt) </th>
                                    <th scope="col" class="col-md-2 py-2" colspan="10">SEED PRODUCTION AGENCIES</th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2"> Total Available Seed (in Qt) </th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">Surplus /Deficit(in Quintals)</th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">SMR Kept in case of multiplication from FS to CS</th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">FS Required to meet targets of CS (in Qt)</th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">SMR Kept in case of multiplication from BS to FS</th>
                                    <th scope="col" class="col-md-2 py-2" rowspan="2">BS Required to meet targets of FS (in Qt)</th>
                        </tr>
                        <tr class="data-row-header">
                            <th scope="col" class="col-md-1 py-2" >DOA</th>
                            <th scope="col" class="col-md-1 py-2" >SSFS</th>
                            <th scope="col" class="col-md-1 py-2" >SSC</th>
                            <th scope="col" class="col-md-1 py-2" >SAUs</th>
                            <th scope="col" class="col-md-1 py-2" >NSC</th>
                            <th scope="col" class="col-md-1 py-2" >Other Govt PSUs</th>
                            <th scope="col" class="col-md-1 py-2" >COOP</th>
                            <th scope="col" class="col-md-1 py-2" >PVT</th>
                            <th scope="col" class="col-md-1 py-2" >Seed Hub</th>
                            <th scope="col" class="col-md-1 py-2" >Other Agency</th>

                </tr>

                                        </thead>
                                        <tbody>
                                            <ng-container *ngFor="let data of finalData; let stateIndex = index">
                                                <ng-container *ngFor="let varietyData of data.variety; let cropIndex = index">
                                                        <tr>
                                                            <td style="text-align: center;" *ngIf="cropIndex === 0"
                                                                [attr.rowspan]="data.variety_count">{{ stateIndex + 1 }}
                                                            </td>
                                                            <td *ngIf="cropIndex === 0 "
                                                            [attr.rowspan]="data.variety_count">{{ (data.crop_name |uppercase) }}</td>
                                                    
                                                            <td 
                                                            >{{ varietyData.variety_name ?
                                                            varietyData.variety_name : 'NA' }}</td>  
                                                            <td style="text-align: center;"
                                                            >{{ varietyData.not_year ?
                                                            varietyData.not_year : '-' }}</td>                                                                                         
                                                             <td style="text-align: center;">{{ varietyData.proposedAreaUnderVariety ? varietyData.proposedAreaUnderVariety : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.seedrate ? varietyData.seedrate : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.SRRTargetbySTATE ? varietyData.SRRTargetbySTATE : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.seedRequired ? varietyData.seedRequired : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.doa ? varietyData.doa : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.ssfs ? varietyData.ssfs : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.ssc ? varietyData.ssc : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.saus ? varietyData.saus : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.nsc ? varietyData.nsc : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.othergovpsu ? varietyData.othergovpsu : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.coop ? varietyData.coop : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.pvt ? varietyData.pvt : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.seedhub ? varietyData.seedhub : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.others ? varietyData.others : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.total ? varietyData.total : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.shtorsur ? varietyData.shtorsur : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.SMRKeptFSToCS ? varietyData.SMRKeptFSToCS : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.FSRequiredtomeettargetsofCS ? varietyData.FSRequiredtomeettargetsofCS : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.SMRKeptBSToFS ? varietyData.SMRKeptBSToFS : 0 }}</td>
                                                             <td style="text-align: center;">{{ varietyData.BSRequiredtomeettargetsofFS ? varietyData.BSRequiredtomeettargetsofFS : 0 }}</td>
                                                            
                                                        </tr>
                                            </ng-container>
                                                <tr>
                                                    <td colspan="4"><b>Crop Group Wise Total</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_area ? data.crop_area:0  }}</b></td>
                                                    <td style="text-align: center;"></td>
                                                    <td style="text-align: center;"></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_seed_req ? data.crop_seed_req:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_doa ? data.crop_doa:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_ssfs ? data.crop_ssfs:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_ssc ? data.crop_ssc:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_saus ? data.crop_saus:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_nsc ? data.crop_nsc:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_othergovpsu ? data.crop_othergovpsu:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_coop ? data.crop_coop:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_pvt ? data.crop_pvt:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_seedhub ? data.crop_seedhub:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_others ? data.crop_others:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_total ? data.crop_total:0  }}</b></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_shtorsur ? data.crop_shtorsur:0  }}</b></td>
                                                    <td style="text-align: center;"></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_FSRequiredtomeettargetsofCS ? data.crop_FSRequiredtomeettargetsofCS:0  }}</b></td>
                                                    <td style="text-align: center;"></td>
                                                    <td style="text-align: center;"><b>{{data && data.crop_BSRequiredtomeettargetsofFS ? data.crop_BSRequiredtomeettargetsofFS:0  }}</b></td>
                                                </tr>
                                                </ng-container>
                                                <ng-container>
                                                    <tr>
                                                        <td colspan="4"
                                                            ><b>TOTAL:</b>
                                                        </td>                                                                                                                                       
                                                        <td style="text-align: center;"><b>{{ totalData.AreaUnderVariety ? totalData.AreaUnderVariety : 0 }}</b></td>
                                                        <td style="text-align: center;"></td>
                                                    <td style="text-align: center;"></td>
                                                        <td style="text-align: center;"><b>{{ totalData.SeedRequired ? totalData.SeedRequired : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.doa ? totalData.doa : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.ssfs ? totalData.ssfs : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.ssc ? totalData.ssc : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.saus ? totalData.saus : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.nsc ? totalData.nsc : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.othergovpsu ? totalData.othergovpsu : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.coop ? totalData.coop : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.pvt ? totalData.pvt : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.seedhub ? totalData.seedhub : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.others ? totalData.others : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.total ? totalData.total : 0 }}</b></td>
                                                        <td style="text-align: center;"><b>{{ totalData.shtorsur ? totalData.shtorsur : 0 }}</b></td>
                                                        <td style="text-align: center;"></td>
                                                        <td style="text-align: center;"><b>{{ totalData.FSRequiredtomeettargetsofCS ? totalData.FSRequiredtomeettargetsofCS : 0 }}</b></td>
                                                        <td style="text-align: center;"></td>
                                                        <td style="text-align: center;"><b>{{ totalData.BSRequiredtomeettargetsofFS ? totalData.BSRequiredtomeettargetsofFS : 0 }}</b></td>
                                                    </tr>
                                           </ng-container>
                                        </tbody>
                        
                                      </table>
        
                                      
                                      
                                    <ng-template #noVarietyData>
                                        <div style="text-align: center; width: 100%;">
                                            <p class="my-2 mx-auto">No Data Found</p>
                                        </div>
                                    </ng-template>
                                </div>
                            </div>
    
    
                        </div>
                    </div>
                </ng-container>
                <ng-container >

                    <div class="col-12 px-4 data-row" style="display: none;" >
                        <div class="list-wrapper px-4 py-3">
                           
                            <br>
                            <div id="excel-table">
                                <div class="row d-md-flex data-row-header extra-header ">
                                  
                                    <div class="col-12 col-md-12 py-3 d-flex justify-content-center">Crop-Wise Seed Rolling Plan</div>
                                   
                                </div>

                                <div class="row d-md-flex data-row-header" style="zoom: 0.9;">
                                    <div class="col-3 py-3 d-flex verticle-content-middle">
                                        Year:
                                        {{enableTable && ngForm.controls['year_of_indent'].value ? ngForm.controls['year_of_indent'].value :''}}
                                        <!-- {{year}}-{{((year+1)-2000)}} -->
                                    </div>
                                    <div class="col-3 py-3 d-flex verticle-content-middle">
                                        Season :
                                        {{ enableTable && ngForm.controls['season'].value? ngForm.controls['season'].value :''}}
                                     
                                    </div>
                                    
                                    <div class="col-2 float-right  py-3 d-flex  float-right " >As on Date : {{today |
                                        date:"dd-MM-YYYY"}}
                                     
                                    </div>
        
                                </div>
                                <div class="row data-row" >
        
                                    <table class="table table-bordered table-responsive"  *ngIf="enableTable">
                                     
                                        <thead>                                        
                                            <tr class="data-row-header">
                                             <th scope="col" class="col-md-1 py-2" rowspan="2">S/N</th>
                                             <th scope="col" class="col-md-3 py-2" rowspan="2">Crop</th>
                                             <th scope="col" class="col-md-3 py-2" rowspan="2">Variety</th>
                                             <th scope="col" class="col-md-3 py-2" rowspan="2">Year of Notification</th>
                                             <th scope="col" class="col-md-2 py-2" rowspan="2">Area (in Ha)</th>
                                             <th scope="col" class="col-md-2 py-2" rowspan="2">Seed Rate (In Qt/Ha)</th>
                                             <th scope="col" class="col-md-3 py-2" rowspan="2">SRR Proposed (by State) % </th>
                                             <th scope="col" class="col-md-2 py-2" rowspan="2">Seed Required (in Qt) </th>
                                             <th scope="col" class="col-md-2 py-2" colspan="10">SEED PRODUCTION AGENCIES</th>
                                             <th scope="col" class="col-md-2 py-2" rowspan="2"> Total Available Seed (in Qt) </th>
                                             <th scope="col" class="col-md-2 py-2" rowspan="2">Surplus /Deficit(in Quintals)</th>
                                             <th scope="col" class="col-md-2 py-2" rowspan="2">SMR Kept in case of multiplication from FS to CS</th>
                                             <th scope="col" class="col-md-2 py-2" rowspan="2">FS Required to meet targets of CS (in Qt)</th>
                                             <th scope="col" class="col-md-2 py-2" rowspan="2">SMR Kept in case of multiplication from BS to FS</th>
                                             <th scope="col" class="col-md-2 py-2" rowspan="2">BS Required to meet targets of FS (in Qt)</th>
                                 </tr>
                                 <tr class="data-row-header">
                                     <th scope="col" class="col-md-1 py-2" >DOA</th>
                                     <th scope="col" class="col-md-1 py-2" >SSFS</th>
                                     <th scope="col" class="col-md-1 py-2" >SSC</th>
                                     <th scope="col" class="col-md-1 py-2" >SAUs</th>
                                     <th scope="col" class="col-md-1 py-2" >NSC</th>
                                     <th scope="col" class="col-md-1 py-2" >Other Govt PSUs</th>
                                     <th scope="col" class="col-md-1 py-2" >COOP</th>
                                     <th scope="col" class="col-md-1 py-2" >PVT</th>
                                     <th scope="col" class="col-md-1 py-2" >Seed Hub</th>
                                     <th scope="col" class="col-md-1 py-2" >Other Agency</th>
         
                         </tr>
         
                                                 </thead>
                                                 <tbody>
                                                     <ng-container *ngFor="let data of finalData; let stateIndex = index">
                                                         <ng-container *ngFor="let varietyData of data.variety; let cropIndex = index">
                                                                 <tr>
                                                                     <td style="text-align: center;" *ngIf="cropIndex === 0"
                                                                         [attr.rowspan]="data.variety_count">{{ stateIndex + 1 }}
                                                                     </td>
                                                                     <td *ngIf="cropIndex === 0 "
                                                                     [attr.rowspan]="data.variety_count">{{ (data.crop_name |uppercase) }}</td>
                                                             
                                                                     <td 
                                                                     >{{ varietyData.variety_name ?
                                                                     varietyData.variety_name : 'NA' }}</td>  
                                                                     <td style="text-align: center;"
                                                                     >{{ varietyData.not_year ?
                                                                     varietyData.not_year : '-' }}</td>                                                                                         
                                                                      <td style="text-align: center;">{{ varietyData.proposedAreaUnderVariety ? varietyData.proposedAreaUnderVariety : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.seedrate ? varietyData.seedrate : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.SRRTargetbySTATE ? varietyData.SRRTargetbySTATE : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.seedRequired ? varietyData.seedRequired : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.doa ? varietyData.doa : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.ssfs ? varietyData.ssfs : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.ssc ? varietyData.ssc : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.saus ? varietyData.saus : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.nsc ? varietyData.nsc : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.othergovpsu ? varietyData.othergovpsu : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.coop ? varietyData.coop : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.pvt ? varietyData.pvt : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.seedhub ? varietyData.seedhub : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.others ? varietyData.others : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.total ? varietyData.total : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.shtorsur ? varietyData.shtorsur : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.SMRKeptFSToCS ? varietyData.SMRKeptFSToCS : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.FSRequiredtomeettargetsofCS ? varietyData.FSRequiredtomeettargetsofCS : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.SMRKeptBSToFS ? varietyData.SMRKeptBSToFS : 0 }}</td>
                                                                      <td style="text-align: center;">{{ varietyData.BSRequiredtomeettargetsofFS ? varietyData.BSRequiredtomeettargetsofFS : 0 }}</td>
                                                                     
                                                                 </tr>
                                                     </ng-container>
                                                         <tr>
                                                             <td colspan="4"><b>Crop Group Wise Total</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_area ? data.crop_area:0  }}</b></td>
                                                             <td style="text-align: center;"></td>
                                                             <td style="text-align: center;"></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_seed_req ? data.crop_seed_req:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_doa ? data.crop_doa:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_ssfs ? data.crop_ssfs:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_ssc ? data.crop_ssc:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_saus ? data.crop_saus:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_nsc ? data.crop_nsc:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_othergovpsu ? data.crop_othergovpsu:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_coop ? data.crop_coop:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_pvt ? data.crop_pvt:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_seedhub ? data.crop_seedhub:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_others ? data.crop_others:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_total ? data.crop_total:0  }}</b></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_shtorsur ? data.crop_shtorsur:0  }}</b></td>
                                                             <td style="text-align: center;"></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_FSRequiredtomeettargetsofCS ? data.crop_FSRequiredtomeettargetsofCS:0  }}</b></td>
                                                             <td style="text-align: center;"></td>
                                                             <td style="text-align: center;"><b>{{data && data.crop_BSRequiredtomeettargetsofFS ? data.crop_BSRequiredtomeettargetsofFS:0  }}</b></td>
                                                         </tr>
                                                         </ng-container>
                                                         <ng-container>
                                                             <tr>
                                                                 <td colspan="4"
                                                                     ><b>TOTAL:</b>
                                                                 </td>                                                                                                                                       
                                                                 <td style="text-align: center;"><b>{{ totalData.AreaUnderVariety ? totalData.AreaUnderVariety : 0 }}</b></td>
                                                                 <td style="text-align: center;"></td>
                                                             <td style="text-align: center;"></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.SeedRequired ? totalData.SeedRequired : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.doa ? totalData.doa : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.ssfs ? totalData.ssfs : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.ssc ? totalData.ssc : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.saus ? totalData.saus : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.nsc ? totalData.nsc : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.othergovpsu ? totalData.othergovpsu : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.coop ? totalData.coop : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.pvt ? totalData.pvt : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.seedhub ? totalData.seedhub : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.others ? totalData.others : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.total ? totalData.total : 0 }}</b></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.shtorsur ? totalData.shtorsur : 0 }}</b></td>
                                                                 <td style="text-align: center;"></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.FSRequiredtomeettargetsofCS ? totalData.FSRequiredtomeettargetsofCS : 0 }}</b></td>
                                                                 <td style="text-align: center;"></td>
                                                                 <td style="text-align: center;"><b>{{ totalData.BSRequiredtomeettargetsofFS ? totalData.BSRequiredtomeettargetsofFS : 0 }}</b></td>
                                                             </tr>
                                                    </ng-container>
                                                 </tbody>
                        
                                      </table>
        
                                      
                                      
                                    <ng-template #noVarietyData>
                                        <div style="text-align: center; width: 100%;">
                                            <p class="my-2 mx-auto">No Data Found</p>
                                        </div>
                                    </ng-template>
                                </div>
                            </div>
    
    
                        </div>
                    </div>
                </ng-container>

                <div class="col-12 px-4 data-row" style="display: none;" >
                    <div class="list-wrapper px-4 py-3">
                       
                        <br>
                        
                        <div class="row data-row" >

                            <table class="table table-bordered table-responsive"  id="excel-tables" >
                              <thead >
                                <tr>
                                    <td>
                                        Crop-Wise Seed Rolling Plan
                                    </td>
                                </tr>
                                <tr>

                                    <td>Year</td>
                                    <td>Season</td>
                                </tr>
                              </thead>
                              <tbody >
                                <tr>

                                    <td>
                                        {{enableTable && ngForm.controls['year_of_indent'].value ? ngForm.controls['year_of_indent'].value :''}}
                                    </td>
                                    <td>
                                        {{ enableTable && ngForm.controls['season'].value ? ngForm.controls['season'].value:''}}
                                 
                                    </td>
                                    
                                </tr>


                              </tbody>
                              <thead>                                        
                                <tr class="data-row-header">
                                 <th scope="col" class="col-md-1 py-2" rowspan="2">S/N</th>
                                 <th scope="col" class="col-md-3 py-2" rowspan="2">Crop</th>
                                 <th scope="col" class="col-md-3 py-2" rowspan="2">Variety</th>
                                 <th scope="col" class="col-md-3 py-2" rowspan="2">Year of Notification</th>
                                 <th scope="col" class="col-md-2 py-2" rowspan="2">Area (in Ha)</th>
                                 <th scope="col" class="col-md-2 py-2" rowspan="2">Seed Rate (In Qt/Ha)</th>
                                 <th scope="col" class="col-md-3 py-2" rowspan="2">SRR Proposed (by State) % </th>
                                 <th scope="col" class="col-md-2 py-2" rowspan="2">Seed Required (in Qt) </th>
                                 <th scope="col" class="col-md-2 py-2" colspan="10">SEED PRODUCTION AGENCIES</th>
                                 <th scope="col" class="col-md-2 py-2" rowspan="2"> Total Available Seed (in Qt) </th>
                                 <th scope="col" class="col-md-2 py-2" rowspan="2">Surplus /Deficit(in Quintals)</th>
                                 <th scope="col" class="col-md-2 py-2" rowspan="2">SMR Kept in case of multiplication from FS to CS</th>
                                 <th scope="col" class="col-md-2 py-2" rowspan="2">FS Required to meet targets of CS (in Qt)</th>
                                 <th scope="col" class="col-md-2 py-2" rowspan="2">SMR Kept in case of multiplication from BS to FS</th>
                                 <th scope="col" class="col-md-2 py-2" rowspan="2">BS Required to meet targets of FS (in Qt)</th>
                     </tr>
                     <tr class="data-row-header">
                         <th scope="col" class="col-md-1 py-2" >DOA</th>
                         <th scope="col" class="col-md-1 py-2" >SSFS</th>
                         <th scope="col" class="col-md-1 py-2" >SSC</th>
                         <th scope="col" class="col-md-1 py-2" >SAUs</th>
                         <th scope="col" class="col-md-1 py-2" >NSC</th>
                         <th scope="col" class="col-md-1 py-2" >Other Govt PSUs</th>
                         <th scope="col" class="col-md-1 py-2" >COOP</th>
                         <th scope="col" class="col-md-1 py-2" >PVT</th>
                         <th scope="col" class="col-md-1 py-2" >Seed Hub</th>
                         <th scope="col" class="col-md-1 py-2" >Other Agency</th>

             </tr>

                                     </thead>
                                     <tbody>
                                         <ng-container *ngFor="let data of finalData; let stateIndex = index">
                                             <ng-container *ngFor="let varietyData of data.variety; let cropIndex = index">
                                                     <tr>
                                                         <td style="text-align: center;" *ngIf="cropIndex === 0"
                                                             [attr.rowspan]="data.variety_count">{{ stateIndex + 1 }}
                                                         </td>
                                                         <td *ngIf="cropIndex === 0 "
                                                         [attr.rowspan]="data.variety_count">{{ (data.crop_name |uppercase) }}</td>
                                                 
                                                         <td 
                                                         >{{ varietyData.variety_name ?
                                                         varietyData.variety_name : 'NA' }}</td>  
                                                         <td style="text-align: center;"
                                                         >{{ varietyData.not_year ?
                                                         varietyData.not_year : '-' }}</td>                                                                                         
                                                          <td style="text-align: center;">{{ varietyData.proposedAreaUnderVariety ? varietyData.proposedAreaUnderVariety : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.seedrate ? varietyData.seedrate : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.SRRTargetbySTATE ? varietyData.SRRTargetbySTATE : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.seedRequired ? varietyData.seedRequired : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.doa ? varietyData.doa : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.ssfs ? varietyData.ssfs : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.ssc ? varietyData.ssc : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.saus ? varietyData.saus : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.nsc ? varietyData.nsc : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.othergovpsu ? varietyData.othergovpsu : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.coop ? varietyData.coop : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.pvt ? varietyData.pvt : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.seedhub ? varietyData.seedhub : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.others ? varietyData.others : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.total ? varietyData.total : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.shtorsur ? varietyData.shtorsur : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.SMRKeptFSToCS ? varietyData.SMRKeptFSToCS : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.FSRequiredtomeettargetsofCS ? varietyData.FSRequiredtomeettargetsofCS : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.SMRKeptBSToFS ? varietyData.SMRKeptBSToFS : 0 }}</td>
                                                          <td style="text-align: center;">{{ varietyData.BSRequiredtomeettargetsofFS ? varietyData.BSRequiredtomeettargetsofFS : 0 }}</td>
                                                         
                                                     </tr>
                                         </ng-container>
                                             <tr>
                                                 <td colspan="4"><b>Crop Group Wise Total</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_area ? data.crop_area:0  }}</b></td>
                                                 <td style="text-align: center;"></td>
                                                 <td style="text-align: center;"></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_seed_req ? data.crop_seed_req:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_doa ? data.crop_doa:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_ssfs ? data.crop_ssfs:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_ssc ? data.crop_ssc:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_saus ? data.crop_saus:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_nsc ? data.crop_nsc:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_othergovpsu ? data.crop_othergovpsu:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_coop ? data.crop_coop:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_pvt ? data.crop_pvt:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_seedhub ? data.crop_seedhub:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_others ? data.crop_others:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_total ? data.crop_total:0  }}</b></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_shtorsur ? data.crop_shtorsur:0  }}</b></td>
                                                 <td style="text-align: center;"></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_FSRequiredtomeettargetsofCS ? data.crop_FSRequiredtomeettargetsofCS:0  }}</b></td>
                                                 <td style="text-align: center;"></td>
                                                 <td style="text-align: center;"><b>{{data && data.crop_BSRequiredtomeettargetsofFS ? data.crop_BSRequiredtomeettargetsofFS:0  }}</b></td>
                                             </tr>
                                             </ng-container>
                                             <ng-container *ngIf="totalData">
                                                 <tr>
                                                     <td colspan="4"
                                                         ><b>TOTAL:</b>
                                                     </td>                                                                                                                                       
                                                     <td style="text-align: center;"><b>{{ totalData.AreaUnderVariety ? totalData.AreaUnderVariety : 0 }}</b></td>
                                                     <td style="text-align: center;"></td>
                                                 <td style="text-align: center;"></td>
                                                     <td style="text-align: center;"><b>{{ totalData.SeedRequired ? totalData.SeedRequired : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.doa ? totalData.doa : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.ssfs ? totalData.ssfs : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.ssc ? totalData.ssc : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.saus ? totalData.saus : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.nsc ? totalData.nsc : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.othergovpsu ? totalData.othergovpsu : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.coop ? totalData.coop : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.pvt ? totalData.pvt : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.seedhub ? totalData.seedhub : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.others ? totalData.others : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.total ? totalData.total : 0 }}</b></td>
                                                     <td style="text-align: center;"><b>{{ totalData.shtorsur ? totalData.shtorsur : 0 }}</b></td>
                                                     <td style="text-align: center;"></td>
                                                     <td style="text-align: center;"><b>{{ totalData.FSRequiredtomeettargetsofCS ? totalData.FSRequiredtomeettargetsofCS : 0 }}</b></td>
                                                     <td style="text-align: center;"></td>
                                                     <td style="text-align: center;"><b>{{ totalData.BSRequiredtomeettargetsofFS ? totalData.BSRequiredtomeettargetsofFS : 0 }}</b></td>
                                                 </tr>
                                        </ng-container>
                                     </tbody>
                
                              </table>

                              
                              
                            <ng-template #noVarietyData>
                                <div style="text-align: center; width: 100%;">
                                    <p class="my-2 mx-auto">No Data Found</p>
                                </div>
                            </ng-template>
                        </div>


                    </div>
                </div>
                <div class="col-12 px-3   py-3">
                    <app-pagination-ui></app-pagination-ui>
                </div>
                <div *ngIf="filterPaginateSearch && filterPaginateSearch.initialized &&(!filterPaginateSearch.itemList || filterPaginateSearch.itemList.length < 1)"
                    class="px-2 py-3 w-100" style="height: 50px;">
                    <div class="d-flex verticle-content-middle justify-content-center w-100">
                        No Data Found.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>